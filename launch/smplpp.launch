<launch>
  <arg name="enable_vposer" default="true" />
  <arg name="enable_ik" default="true" />
  <arg name="enable_qp" default="true" />
  <arg name="solve_mocap_body" default="false" />
  <arg name="solve_mocap_motion" default="false" />
  <arg name="enable_vertex_color" default="true" />
  <arg name="visualize_normal" default="false" />
  <arg name="device" default="CPU" />

  <node pkg="smplpp" type="node" name="smplpp"
        output="screen" clear_params="true" >
    <rosparam subst_value="true">
      enable_vposer: $(arg enable_vposer)
      enable_ik: $(arg enable_ik)
      enable_qp: $(arg enable_qp)
      solve_mocap_body: $(arg solve_mocap_body)
      solve_mocap_motion: $(arg solve_mocap_motion)
      mocap_frame_idx: 10
      enable_vertex_color: $(arg enable_vertex_color)
      visualize_normal: $(arg visualize_normal)
      smpl_path: $(find smplpp)/data/smpl_male.json
      vposer_path: $(find smplpp)/data/vposer_parameters.json
      mocap_path: $(find smplpp)/data/sample_walk.c3d
      device: $(arg device)
      rate: 30.0
      <!-- initial_rpy: [1.57, 0.0, 1.57] -->
      initial_rpy: [1.57, 0.0, 3.14]
    </rosparam>
  </node>

  <node if="$(arg enable_ik)"
        pkg="smplpp" type="IkTargetManager.py" name="ik_target_manager" output="screen" >
    <remap from="ik_target_pose" to="smplpp/ik_target_pose" />
  </node>

  <node pkg="rviz" type="rviz" name="$(anon rviz)"
        args="-d $(find smplpp)/rviz/smplpp.rviz" />

  <group unless="$(arg enable_ik)" >
    <node if="$(arg enable_vposer)"
          pkg="rqt_ez_publisher" type="rqt_ez_publisher" name="rqt_ez_publisher_latent_pose"
          args="--slider-file $(find smplpp)/rqt/smplpp_latent_pose.yaml"
          output="log" clear_params="true" />
    <node unless="$(arg enable_vposer)"
          pkg="rqt_ez_publisher" type="rqt_ez_publisher" name="rqt_ez_publisher_pose"
          args="--slider-file $(find smplpp)/rqt/smplpp_pose.yaml"
          output="log" clear_params="true" />
  </group>

  <group unless="$(arg solve_mocap_body)" >
    <node unless="$(arg solve_mocap_motion)"
          pkg="rqt_ez_publisher" type="rqt_ez_publisher" name="rqt_ez_publisher_shape"
          args="--slider-file $(find smplpp)/rqt/smplpp_shape.yaml"
          output="log" clear_params="true" />
  </group>
</launch>
